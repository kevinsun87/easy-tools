import{_ as e,p as l,q as a,t as s,z as o,a_ as t,aX as i,a as r,G as n,H as d,I as p,u as c,L as u,K as m,bb as f,b0 as g,s as h,bF as y,bH as b,c as v,aV as w,B as x,F as j,y as _,v as k,x as V,J as I,bn as T,h as C,r as q}from"./index-CyyLRP8W.js";/* empty css            *//* empty css                  */import{E}from"./el-dialog-BoL22f5R.js";/* empty css                   */import A from"./d-button-COA-aPKt.js";/* empty css                 */import{a as F,E as P}from"./el-form-item-Bc1ZcHOk.js";import{a as U,b as D,A as B,c as S,d as z}from"./public-api-DxRCcbRs.js";import{aG as L,aH as K,n as R,aI as Q,J as G,l as H}from"./todo-nv2WtoEp.js";import{u as O}from"./userInfo-CZAB7rZN.js";import{E as J}from"./el-radio-vuBnWJsl.js";import{SAVE_CONFIG as M}from"./save_config-BtHImbsT.js";import{E as $}from"./index-BPnMED6p.js";import"./css-D3Kd0WPg.js";import{c as N}from"./getAudio-D_HGGnT2.js";import{E as W}from"./index-BvBbK8nS.js";import{ElMessage as X}from"./index-BU0epQJo.js";import{b as Z}from"./baseRequest-CU9cTnaC.js";import{E as Y}from"./el-image-viewer-BDwDTkkr.js";import"./css-DsIEOZKU.js";import{E as ee}from"./index-CMn5lzXr.js";import"./index-CdRnR6wp.js";import"./index-B3sKL47p.js";import"./scroll-3JEGyj3w.js";import"./style-BBQwFGbP.js";import"./types-Ci7ev57k.js";import"./vnode-CwyaGvUL.js";import"./index-D4GlTUBi.js";import"./plugin-vue_export-helper-O3gUY6pX.js";import"./use-dialog-0gmd-idO.js";import"./icon-Dsqoi_oS.js";import"./event-BwRzfsZt.js";import"./index-CB1eEFAV.js";import"./_baseGet-DEcaJYAt.js";import"./isSymbol-Bt1TyP4H.js";import"./focus-trap-D8QWET1-.js";import"./aria-BUADUvnR.js";import"./use-global-config-DcVlDyFX.js";import"./index-CXKOYI6o.js";import"./isUndefined-DgmxjSXK.js";import"./index-hc1PwDik.js";import"./index-DjlyN6je.js";import"./constants-Dnj8X3EN.js";import"./castArray-LUE-lsy0.js";import"./use-form-item-CUGNa-4i.js";import"./index-BrMlOSMZ.js";import"./localforage-BVRgvwJc.js";import"./website-CoEF8fmW.js";import"./index-DvjFJXYU.js";import"./indexdb-D6yYQ1E4.js";import"./eventBus-BB4cUTPt.js";import"./index-kxe6IHwf.js";import"./hasIn-y6DbaUwA.js";import"./debounce-Dd9nEzpy.js";import"./version-DYnJBHiW.js";import"./typescript-CRqm1_SZ.js";import"./index-DsFsGggn.js";import"./config-provider-Bf5G9WCh.js";import"./index-BFuAB0_P.js";import"./throttle-1HGvzIm8.js";import"./position-C03YnYn2.js";import"./aria-C-hsWcn7.js";import"./validator-DvohupZ1.js";const le="function"==typeof Buffer;"function"==typeof TextDecoder&&new TextDecoder;const ae="function"==typeof TextEncoder?new TextEncoder:void 0,se=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=");(e=>{let l={};se.forEach(((e,a)=>l[e]=a))})();const oe=String.fromCharCode.bind(String);"function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array);const te="function"==typeof btoa?e=>btoa(e):le?e=>Buffer.from(e,"binary").toString("base64"):e=>{let l,a,s,o,t="";const i=e.length%3;for(let r=0;r<e.length;){if((a=e.charCodeAt(r++))>255||(s=e.charCodeAt(r++))>255||(o=e.charCodeAt(r++))>255)throw new TypeError("invalid character found");l=a<<16|s<<8|o,t+=se[l>>18&63]+se[l>>12&63]+se[l>>6&63]+se[63&l]}return i?t.slice(0,i-3)+"===".substring(i):t},ie=le?e=>Buffer.from(e).toString("base64"):e=>{let l=[];for(let a=0,s=e.length;a<s;a+=4096)l.push(oe.apply(null,e.subarray(a,a+4096)));return te(l.join(""))},re=e=>{if(e.length<2)return(l=e.charCodeAt(0))<128?e:l<2048?oe(192|l>>>6)+oe(128|63&l):oe(224|l>>>12&15)+oe(128|l>>>6&63)+oe(128|63&l);var l=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return oe(240|l>>>18&7)+oe(128|l>>>12&63)+oe(128|l>>>6&63)+oe(128|63&l)},ne=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,de=le?e=>Buffer.from(e,"utf8").toString("base64"):ae?e=>ie(ae.encode(e)):e=>te(e.replace(ne,re)),pe=(e,l=!1)=>l?(e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_")))(de(e)):de(e),ce=e=>(t("data-v-730c6d62"),e=e(),i(),e),ue=[ce((()=>s("span",{class:"brid-body bg-cover bg-center bg-no-repeat absolute left-1/2"},null,-1))),ce((()=>s("span",{class:"brid-claw left"},null,-1))),ce((()=>s("span",{class:"brid-claw right"},null,-1)))],me=e({__name:"noPassword",props:{inputPass:{type:Boolean,defautl:!1}},setup(e){const t=e;return(e,i)=>(l(),a("div",null,[s("div",{class:o(["login-bird relative",{password:t.inputPass}])},ue,2)]))}},[["__scopeId","data-v-730c6d62"]]),fe=s("div",null,[s("h2",{class:"ac f18 mb10 pt30"},"选择账号数据")],-1),ge=s("p",{class:"f12 d-sub ac"}," 检测到云端数据和本地数据不一致，请选择使用其中某一项数据 ",-1),he={style:{padding:"20px 40px 40px"}},ye={class:"ac mt30"},be={__name:"selectData",emits:["submit"],setup(e,{emit:a}){const o=r(2),t=a;function i(){t("submit",o.value)}return(e,a)=>(l(),n(c(E),m({"append-to-body":!0,width:"400px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},e.$attrs),{default:d((()=>[fe,ge,s("div",he,[s("p",null,[p(c(J),{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),label:1},{default:d((()=>[u("使用本地数据")])),_:1},8,["modelValue"])]),s("p",null,[p(c(J),{modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=e=>o.value=e),label:2},{default:d((()=>[u("使用云端数据")])),_:1},8,["modelValue"])]),s("p",ye,[p(A,{onClick:i,class:"w-full",type:"primary"},{default:d((()=>[u("确定")])),_:1})])])])),_:1},16))}},ve=s("div",{class:"ar",style:{margin:"-15px 0 10px 0"}},[s("a",{class:"d-main f12",target:"_blank",href:"https://codelife.cc/account/pass?type=find"},"忘记密码")],-1),we={__name:"login",emits:["close"],setup(e,{expose:s,emit:o}){const t=o,i=O(),r=f({email:"",password:""}),n=g({loading:!1,userInfo:{},selectDataVisible:!1,dataActive:2,isInputPass:!1}),m=h(null),v=()=>{n.loading=!0;let e={};e.email=r.email,e.from="itab",e.password=pe(r.password),e.t=(new Date).getTime(),U(e).then((e=>{200==e.code&&w(e)})).finally((()=>{n.loading=!1}))};function w(e){if(n.userInfo=e.data||{},!e.token)return;n.userInfo.token=e.token;let l=!1;n.userInfo.upTime&&(l=!0);for(let a in n.userInfo.itabAsyncTime)1!=n.userInfo.itabAsyncTime[a]&&(l=!0);l?n.selectDataVisible=!0:(i.value=n.userInfo,R.set("token",n.userInfo.token),t("close"))}function x(e){i.value=n.userInfo,R.set("token",n.userInfo.token),2==e?(D(),B(null,n.userInfo.itabAsyncTime)):M(null,!0,!0),n.selectDataVisible=!1,t("close")}return s({loginSuccess:w}),(e,s)=>(l(),a("div",null,[p(me,{inputPass:n.isInputPass},null,8,["inputPass"]),p(c(P),{onSubmit:s[4]||(s[4]=b((()=>{}),["prevent"])),size:"large",model:c(r),ref_key:"refLoginForm",ref:m,"label-position":"right"},{default:d((()=>[p(c(F),{prop:"email",rules:{required:!0,type:"email",message:"邮箱格式不正确"}},{default:d((()=>[p(c($),{"prefix-icon":c(L),maxlength:"40",modelValue:c(r).email,"onUpdate:modelValue":s[0]||(s[0]=e=>c(r).email=e),placeholder:"请输入邮箱"},null,8,["prefix-icon","modelValue"])])),_:1}),p(c(F),{prop:"password",rules:{required:!0,message:"密码不能为空"}},{default:d((()=>[p(c($),{onKeydown:y(v,["enter"]),maxlength:"20","show-password":"","prefix-icon":c(K),type:"password",modelValue:c(r).password,"onUpdate:modelValue":s[1]||(s[1]=e=>c(r).password=e),onFocus:s[2]||(s[2]=e=>n.isInputPass=!0),onBlur:s[3]||(s[3]=e=>n.isInputPass=!1),placeholder:"请输入6-18位密码"},null,8,["prefix-icon","modelValue"])])),_:1}),ve,p(A,{round:"",size:"large",onClick:v,type:"primary",class:"w-full",loading:n.loading},{default:d((()=>[u("立即登录")])),_:1},8,["loading"])])),_:1},8,["model"]),p(be,{modelValue:n.selectDataVisible,"onUpdate:modelValue":s[5]||(s[5]=e=>n.selectDataVisible=e),onSubmit:x},null,8,["modelValue"])]))}},xe={class:"d-flex-between w-full"},je={__name:"register",emits:["close"],setup(e,{emit:o}){const t=O(),i=o,r=f({timer:null,loading:!1,timerText:"获取验证码",setp:0,isInputPass:!1}),n=f({email:"",username:"",password:"",verifyKey:"",source:N()}),m=h(null);const g=v((()=>!Q(n.email)));v((()=>!Q(n.email)));const y=()=>{Q(n.email)?(r.timerText=10,r.timer=setInterval((()=>{r.timerText--,r.timerText<=0&&(clearInterval(r.timer),r.timerText="获取验证码")}),1e3),S({email:n.email}).then((e=>{X.success("验证码发送成功")}))):X.warning("请输入正确的邮箱")};function j(){m.value.validate((e=>{if(!e)return;r.loading=!0;let l={...n,password:pe(n.password)};l.t=(new Date).getTime(),z(l).then((e=>{let l=e.data||{};t.value=l,R.set("token",e.token),X.success("注册成功"),i("close")})).finally((()=>{r.loading=!1}))}))}return w((()=>{clearInterval(r.timer)})),(e,o)=>(l(),a("div",null,[p(me,{inputPass:c(r).isInputPass},null,8,["inputPass"]),p(c(P),{onSubmit:o[6]||(o[6]=b((()=>{}),["prevent"])),size:"default",model:c(n),ref_key:"refLoginForm",ref:m,"label-position":"right"},{default:d((()=>[p(c(F),{prop:"email",rules:{required:!0,type:"email",message:"邮箱格式不正确"}},{default:d((()=>[s("div",xe,[p(c($),{autocomplete:"off",maxlength:"40",modelValue:c(n).email,"onUpdate:modelValue":o[0]||(o[0]=e=>c(n).email=e),modelModifiers:{trim:!0},placeholder:"请输入邮箱"},null,8,["modelValue"]),p(c(W),{style:{width:"90px"},type:"primary",class:"ml5",disabled:g.value||"获取验证码"!=c(r).timerText,onClick:y},{default:d((()=>[u(x(c(r).timerText),1)])),_:1},8,["disabled"])])])),_:1}),p(c(F),{prop:"verifyKey",rules:{required:!0,message:"验证码不能为空"}},{default:d((()=>[p(c($),{autocomplete:"off",maxlength:"6",modelValue:c(n).verifyKey,"onUpdate:modelValue":o[1]||(o[1]=e=>c(n).verifyKey=e),placeholder:"请输入6位邮箱验证码"},null,8,["modelValue"])])),_:1}),p(c(F),{prop:"username",rules:{required:!0,message:"请输入用户名"}},{default:d((()=>[p(c($),{autocomplete:"off",maxlength:"18",modelValue:c(n).username,"onUpdate:modelValue":o[2]||(o[2]=e=>c(n).username=e),modelModifiers:{trim:!0},placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),p(c(F),{prop:"password",rules:{required:!0,message:"密码不能为空"}},{default:d((()=>[p(c($),{autocomplete:"off",maxlength:"20","show-password":"",type:"password",onFocus:o[3]||(o[3]=e=>c(r).isInputPass=!0),onBlur:o[4]||(o[4]=e=>c(r).isInputPass=!1),modelValue:c(n).password,"onUpdate:modelValue":o[5]||(o[5]=e=>c(n).password=e),placeholder:"请输入8-18密码"},null,8,["modelValue"])])),_:1}),p(A,{size:"large",round:"",loading:c(r).loading,onClick:j,type:"primary",class:"w-full"},{default:d((()=>[u("立即注册 ")])),_:1},8,["loading"])])),_:1},8,["model"])]))}},_e={class:"flex justify-between items-center login-third mt-3"},ke=(e=>(t("data-v-470ef09c"),e=e(),i(),e))((()=>s("div",null,"第三方账号登录",-1))),Ve={class:"flex"},Ie=["href","onClick"],Te=["src"],Ce=e({__name:"loginThird",emits:["loginThird"],setup(e,{emit:o}){const t=o,i=[{url:"https://api.weibo.com/oauth2/authorize?client_id=3805380913&redirect_uri=https://www.codelife.cc/logincb&response_type=code&state=&scope=all",icon:"weibo"},{url:"https://graph.qq.com/oauth2.0/show?which=Login&display=pc&response_type=code&client_id=101983660&redirect_uri=https%3A%2F%2Fwww.codelife.cc%2Flogincb&state=qq",icon:"qq"},{url:"https://github.com/login/oauth/authorize?client_id=930860aee1b7c1ce56ee&scope=user",icon:"github"}];return(e,o)=>(l(),a("div",_e,[ke,s("div",Ve,[(l(),a(j,null,_(i,(e=>s("span",{href:e.url,key:e.icon,onClick:l=>(e=>{window.open(e.url,"_blank","width=800,height=500"),window.addEventListener("message",(e=>{let l=e.data||{};t("loginThird",l)}),!1)})(e)},[s("img",{style:{width:"24px",height:"24px"},src:`./login/${e.icon}.svg`},null,8,Te)],8,Ie))),64))])]))}},[["__scopeId","data-v-470ef09c"]]),qe=""+new URL("../login/wechat.svg",import.meta.url).href,Ee=e=>(t("data-v-c5bc2aa1"),e=e(),i(),e),Ae={class:"login-wechat ac"},Fe=Ee((()=>s("img",{class:"wechat-logo",src:qe},null,-1))),Pe=Ee((()=>s("p",null,"微信登录",-1))),Ue={class:"wechat-qrcode rounded-md overflow-hidden"},De={class:"wechat-loading d-flex-center"},Be={class:"f14 d-flex-x"},Se={class:"d-icon mr5",style:{"font-size":"18px"}},ze=Ee((()=>s("p",{class:"ac mb20"},[u(" 打开微信 "),s("b",{calss:"b"},"扫一扫"),u("， "),s("b",{calss:"b"},"关注公众号"),u("后即可登录/注册 ")],-1))),Le=Ee((()=>s("p",{class:"ac mt20 f16"},[s("b",null,"绑定邮箱")],-1))),Ke={class:"login-tabs d-flex ac mb10"},Re=["onClick"],Qe={class:"ar",style:{margin:"-15px 0 10px 0"}},Ge={key:0,class:"d-main f12",target:"_blank",href:"https://codelife.cc/account/pass?type=find"},He={name:"wechat-login"},Oe=e(Object.assign(He,{emits:["loginThird"],setup(e,{emit:t}){const i=[{name:"绑定老用户",key:"old"},{name:"绑定新用户",key:"new"}],r=t,n=f({loading:!1,isQRcodeExpire:!1}),m=f({img:"",ticket:""}),g=h(!1),v=f({email:"",password:"",wechatOpenid:"",userType:"old"});let T=null,C=0;function q(){T&&clearInterval(T),n.isQRcodeExpire=!1,T=setInterval((()=>{m.ticket&&(C+=2,C>30&&(clearInterval(T),C=0,n.isQRcodeExpire=!0),((e={})=>Z.get("/user/wechatLogin/info",{params:e}))({ticket:m.ticket}).then((e=>{e.data.success&&(clearInterval(T),e.token?r("loginThird",e):(v.wechatOpenid=e.data.wechat_openid,ee.confirm("是否绑定邮箱?",{confirmButtonText:"先不绑定",cancelButtonText:"是的",center:!0}).then((()=>{E("skip")})).catch((()=>{g.value=!0}))))})))}),2800),n.loading=!0,Z.get("/user/wechat/qrcode").then((e=>{let l=e.data||{};m.img=l.img,m.ticket=l.ticket})).finally((()=>{n.loading=!1}))}q(),w((()=>{T&&clearInterval(T)}));const E=e=>{n.loading=!0;let l={...v};l.from="wechat","skip"==e?(l.email="",l.userType="skip",l.password=""):l.password=pe(v.password),((e={})=>Z.post("/user/wechatBindEmail",e))(l).then((e=>{200==e.code&&r("loginThird",e)})).finally((()=>{n.loading=!1}))},U=e=>{};return(e,t)=>(l(),a("div",Ae,[k(s("span",null,[Fe,Pe,s("div",Ue,[k(s("span",{onClick:t[0]||(t[0]=e=>q()),class:"wechat-qrcode-refresh d-icon"},[p(c(G))],512),[[V,c(n).isQRcodeExpire]]),k(s("span",De,[s("span",Be,[s("i",Se,[p(c(H),{class:"rotating"})]),u(" 加载中")])],512),[[V,c(n).loading]]),p(c(Y),{onError:U,class:"size-full inline-block",alt:"加载二维码",src:c(m).img},null,8,["src"])]),ze],512),[[V,!g.value]]),k(s("span",null,[Le,s("ul",Ke,[(l(),a(j,null,_(i,(e=>s("li",{class:o(["d-cell",{active:c(v).userType===e.key}]),key:e.key,onClick:l=>c(v).userType=e.key},x(e.name),11,Re))),64))]),p(c(P),{onSubmit:t[3]||(t[3]=b((()=>{}),["prevent"])),size:"large",model:c(v),ref:"refLoginForm","label-position":"right"},{default:d((()=>[p(c(F),{prop:"email",rules:{required:!0,type:"email",message:"邮箱格式不正确"}},{default:d((()=>[p(c($),{"prefix-icon":c(L),maxlength:"40",modelValue:c(v).email,"onUpdate:modelValue":t[1]||(t[1]=e=>c(v).email=e),placeholder:"请输入邮箱"},null,8,["prefix-icon","modelValue"])])),_:1}),p(c(F),{prop:"password",rules:{required:!0,message:"密码不能为空"}},{default:d((()=>[p(c($),{onKeydown:y(E,["enter"]),maxlength:"20","show-password":"","prefix-icon":c(K),type:"password",modelValue:c(v).password,"onUpdate:modelValue":t[2]||(t[2]=e=>c(v).password=e),placeholder:"请输入6-18位密码"},null,8,["prefix-icon","modelValue"])])),_:1}),s("div",Qe,["old"==c(v).userType?(l(),a("a",Ge,"忘记密码")):I("",!0)]),p(A,{round:"",onClick:E,type:"primary",class:"mt10 mb20 w-full",loading:c(n).loading},{default:d((()=>[u("立即登录")])),_:1},8,["loading"])])),_:1},8,["model"])],512),[[V,g.value]])]))}}),[["__scopeId","data-v-c5bc2aa1"]]),Je={class:"app-login h-full"},Me={class:"login-tabs d-flex b ac mb10"},$e=["onClick"],Ne={class:"login-tip ac"},We={key:0,class:"mt5"},Xe={class:"pl30 pr30 mb30"},Ze={class:"ac mt5"},Ye=e({__name:"index",props:{type:String},setup(e){const t=T(),i=r(e.type),m=r(null),f=r([{name:"扫码登录",key:"scan"},{name:"其他方式登录",key:"other"}]),g=r("scan");const h=e=>{m.value.loginSuccess(e)};function y(){t.onClose()}return(e,t)=>(l(),n(c(E),{top:"10vh",class:"login-dialog","close-on-press-escape":!1,"close-on-click-modal":!1,width:"420px"},{default:d((()=>[s("div",Je,[s("ul",Me,[(l(!0),a(j,null,_(f.value,(e=>(l(),a("li",{class:o(["d-cell",{active:g.value===e.key}]),key:e.key,onClick:l=>g.value=e.key},x(e.name),11,$e)))),128))]),"scan"==g.value?(l(),n(Oe,{key:0,onLoginThird:h})):I("",!0),k(s("span",null,[s("div",Ne,["firefox"==c(N)()?(l(),a("p",We," 火狐暂不支持第三方登录 ")):I("",!0)]),s("div",Xe,[k(p(we,{ref_key:"loginRef",ref:m,onClose:y},null,512),[[V,"login"==i.value]]),k(p(je,{onClose:y},null,512),[[V,"reg"==i.value]]),p(Ce,{onLoginThird:h}),s("div",Ze,[u(x("login"==i.value?"还没有账号":" 已有账号？")+" ",1),p(A,{text:"",onClick:t[0]||(t[0]=e=>{return l="reg"==i.value?"login":"reg",void(i.value=l);var l})},{default:d((()=>[u("立即"+x("login"==i.value?"注册":"登录"),1)])),_:1})])])],512),[[V,"other"==g.value]])])])),_:1}))}},[["__scopeId","data-v-0170a596"]]),el=e=>{const l=C(Ye,{modelValue:!0,type:e,onClose:()=>{setTimeout((()=>{q(null,document.body)}),300)}});q(l,document.body)};export{el as default};
