import{d as e,n as t}from"./index-CyyLRP8W.js";import{g as n}from"./position-C03YnYn2.js";import{t as l,g as o}from"./scroll-3JEGyj3w.js";import{t as i}from"./throttle-1HGvzIm8.js";import"./types-Ci7ev57k.js";import"./style-BBQwFGbP.js";import"./debounce-Dd9nEzpy.js";import"./todo-nv2WtoEp.js";import"./isSymbol-Bt1TyP4H.js";const s="ElInfiniteScroll",r={delay:{type:Number,default:200},distance:{type:Number,default:0},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},c=(e,t)=>Object.entries(r).reduce(((n,[l,o])=>{var i,s;const{type:r,default:c}=o,a=e.getAttribute(`infinite-scroll-${l}`);let d=null!=(s=null!=(i=t[a])?i:a)?s:c;return d="false"!==d&&d,d=r(d),n[l]=Number.isNaN(d)?c:d,n}),{}),a=e=>{const{observer:t}=e[s];t&&(t.disconnect(),delete e[s].observer)},d=(e,t)=>{const{container:l,containerEl:o,instance:i,observer:r,lastScrollTop:a}=e[s],{disabled:d,distance:u}=c(e,i),{clientHeight:m,scrollHeight:b,scrollTop:p}=o,f=p-a;if(e[s].lastScrollTop=p,r||d||f<0)return;let v=!1;if(l===e)v=b-(m+p)<=u;else{const{clientTop:t,scrollHeight:l}=e;v=p+m>=n(e,o)+t+l-u}v&&t.call(i)};function u(e,t){const{containerEl:n,instance:l}=e[s],{disabled:o}=c(e,l);o||0===n.clientHeight||(n.scrollHeight<=n.clientHeight?t.call(l):a(e))}const m={async mounted(n,r){const{instance:a,value:m}=r;e(m)||l(s,"'v-infinite-scroll' binding value must be a function"),await t();const{delay:b,immediate:p}=c(n,a),f=o(n,!0),v=f===window?document.documentElement:f,y=i(d.bind(null,n,m),b);if(f){if(n[s]={instance:a,container:f,containerEl:v,delay:b,cb:m,onScroll:y,lastScrollTop:v.scrollTop},p){const e=new MutationObserver(i(u.bind(null,n,m),50));n[s].observer=e,e.observe(n,{childList:!0,subtree:!0}),u(n,m)}f.addEventListener("scroll",y)}},unmounted(e){if(!e[s])return;const{container:t,onScroll:n}=e[s];null==t||t.removeEventListener("scroll",n),a(e)},async updated(e){if(e[s]){const{containerEl:t,cb:n,observer:l}=e[s];t.clientHeight&&l&&u(e,n)}else await t()},install:e=>{e.directive("InfiniteScroll",m)}},b=m;export{b as ElInfiniteScroll,m as default};
